OSPF 开放式最短路径优先协议，它是基于链路状态的内部网关协议，用于在单一自治系统内决策路由，而RIP是距离矢量路由协议。

OSPF采用Dijkstra算法计算路由，算法对自己以及其他路由器产生的链路状态信息进行汇总，在本地生成一个链路状态数据库，通过对此数据库进行运算得到以自己为根的最短路径树。

一旦网络拓扑结构发生变化，会有相应类型的链路状态通告（LSA）被发送出去，各个路由器收集LSA后随即重新计算新的路由表。网络规模不同，收敛时间不同，一般小规模网络收敛时间可达十多秒。

OSPF的特点：适应范围广、快速收敛、无自环、允许区域划分、支持等价路由、使用路由分级、支持验证和使用组播发送。

---

Loopback地址：本地环回端口，是一种虚拟端口，常作为路由器的管理地址。在网络规划后为方便管理，往往在没一台路由器上创建一个Loopback端口，并再改端口指定一个单独的IP地址作为管理地址，管理者通过该地址进行远程登陆，该地址起到了类似于设备名称的功能。

Loopback也用作OSPF的路由ID，路由ID为路由器唯一标识并在自治系统内唯一。Loopback端口的IP地址通常被作为路由器标识。

---

OSPF数据包

1. Hello报文：发现邻居
2. 数据库描述报文：(数据库交换期间产生）交换LSA头部
3. 链路状态请求：请求指定的LSA数据细节
4. 链路状态更新：发送被请求的LSA数据包，也用于多个LSA泛洪，若有一个泛洪没有被确认，5秒后重传
5. 链路状态确认：对链路实验更新包进行确认

---

LSA数据包类型

1. 路由器LSA：描述路由器的链路状态和开销，传递到整个区域
2. 网络LSA：描述本网段的链路状态，传递到整个区域
3. 网络汇总LSA：描述网络某一网段的路由，传递到整个区域
4. ASBR汇总LSA
5. AS扩展LSA

---

OSPF工作过程

1. 建立路由器的邻接关系
   * 路由器发送具有自身ID的Hello报文，与之相邻的路由器收到该报文，则将该报文的ID信息加入到自己的Hello报文内
   * 如果路由器某端口收到其他路由器发来的、含有自身ID的Hello报文，则它根据该端口所在的网络类型确定是否可以建立邻接关系 
2. 选举DR(指派路由器）/BDR（备份指派路由器
   * 优先权值最高的DR
3. 发现路由器
4. 选择适当的路由器
5. 维护路由信息

