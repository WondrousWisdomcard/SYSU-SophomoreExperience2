[toc]

# 计算机网络与因特网

## 1.1 什么是因特网

### 1.1.1 具体构成描述

**主机**（host）又称为端系统（end system），通过**通信链路**（communication link）和**分组交换机**（packet switch）连接在一起。通信链路由不同类型的物理媒介组成（有线和无线），包括电缆，铜线，光纤，无线电频谱等。链路的传播速度以**bps**（bit per second）度量。分组交换机从一条入通信链路接受到达的分组，并从一条出通信链路转发该分组，种类有路由器（router）和链路层交换机（link-layer switch）等。

其中，**分组**（packet）是端系统向另一端系统发送数据时将数据分段，并为每段加上首部字节而形成的信息包。从发送端系统到接收端系统，一个分组经历的通信链路和分组交换机成为通过该网络的路径。（route或path）。

端系统通过ISP（因特网服务提供商）接入因特网，每个ISP都是有一个或多个分组交换机和多端通信链路组成的网络，不同的ISP为端系统提供了不同类型的网络接入。ISP也对内容提供者提供互联网接入服务，将Web站点接入互联网。每个ISP独立管理，运行IP协议。

端系统，分组交换机和其他因特网部件都需要运行控制因特网中信息接收和发送的一系列协议（protocol）。IEIF研发了因特网标准，其标准文档被称为RFC（请求评论）。

### 1.1.2 服务描述

另一种角度来描述因特网：从**应用程序提供服务的基础设施**的角度。对应的程序称为分布式应用程序（distributed application），它们涉及多台相互交换数据的端系统。

与因特网相连的端系统提供了一个**应用程序编程接口**（API），API规定了一个端系统上的软件请求因特网基础设施像运行在另一个端系统上的目的软件交付数据的方式。API是一套发送软件必须遵循的规则合集。

总而言之，因特网是一种基础设施，新的应用程序正在其上不断地被发明和放置。

### 1.1.3 什么是协议

**一个协议定义了在两个或者多个通信实体之间交换的报文格式和次序，以及报文传输或接收所采取的行动。**

## 1.2 网络边缘

位于网络的边缘，因特网的端系统包括桌面计算机，服务器和移动计算机等。端系统又称为主机，**主机又分为客户机（client）和服务器（server）。**

### 1.2.1 客户机与服务器程序

客户机程序是运行在一个端系统上的程序，发出请求，并从运行在另一个端系统上的服务器程序接受服务。

对于P2P应用程序，端系统相互作用并运行执行客户机和服务器功能。

### 1.2.2 接入网

**接入网是将端系统连接到其边缘路由器（edge router）的物理链路**。网络接入的三种类型：住宅接入，公司接入，无线接入。

一种**住宅接入**形式是**通过普通模拟电话用拨号调制解调器（dial-up modem）与住宅ISP相连**。该接入网络仅是连同一条点对点拨号电话线一起的一对调制解调器，速度缓慢。

另一种为**新型宽带接入技术**。宽带住宅区接入有：**数字用户线DSL，和混合光纤同轴电缆HFC**。

 对于DSL，其传输速率在两个方向上是不对称的，下载高于上传，DSL在家庭和ISP之间将通信链路分为三个不重叠的频段：高速下行信道，中速上行信道，普通双向电话信道，使得电话呼叫和因特网连接能同时共享链路。  

 HFC接入网扩展了用于广播电缆电视的电缆网络。光缆连接了电缆头端到相邻域级的连接点，从这里再用传统同轴电缆到达各家庭住宅。HFC需要特制的电缆调制解调器。
    
 DSL建立点对点连接保证宽带专用；HFC则可以提供比DSL更大的宽带；卫星链路也可以将住宅与因特网相连。

**公司接入**通常**使用局域网LAN来连接用户与边缘路由器**。**以太网技术**是当前公司网络中最为流行的接入技术。共享以太网技术使用共享媒体，端系统共享LAN的传输速率。交换以太网技术则允许所有主机以LAN全部速率同时发送和接受。

**无线接入**主要有：**无线局域网**（又被称为WiFi）和**广域无线接入网。**

在**无线局域网**中，无线用户与位于几十米半径内的基站之间传输/接收分组，基站通常与有线因特网相连接。在**广域无线接入网**中，分使使用蜂窝电话的相同无线基础设施进行发送，电信管理的基站为数万米半径内用户提供无线接入服务。

### 1.2.3 物理媒体

对于每个传输接受对，通过跨越一种物理媒体传播电磁波或光脉冲来发送该比特。物理媒体包括：导引型媒体（如光缆，双绞铜线，同轴电缆）和非导引型媒体（如无线局域网或数字卫星频道）。

## 1.3 网络核心

### 1.3.1 电路交换和分组交换

电路交换和分组交换是通过网络链路和交换机移动数据的两种基本方法。在电路交换网络中，沿着端系统通信路径，为端系统之间通信所提供的资源（**缓存，链路传输速率**等）会在通信会话期被**预留**，而在分组交换网络中则不会，使数据传输在分布交换网络可能需要**排队**。

因特网是分组交换网络的典范，如果因为其他分组需要同时经过某链路发送，使该链路变得堵塞，则分组将在传输链路的发送侧的缓存中等待，从而形成时延。因特网尽力而为，不做确保。

**电路交换网络中的多路复用**：通过**频分多路复用FDM**或者**时分多路复用TDM**实现。对于FDM，链路的频谱由跨越链路创建的所有连接所共享，连接期每条连接专用一个频段，频段的宽度称为**宽带Bandwidth**；对于TDM链路，时间被划分为固定区间的帧，并且每一帧被划分为固定数量的时隙。这些时隙专门由该链接单独使用，**一条电路的传输速率等于一个时隙中的比特数乘以该帧的速率**。

电路交换网络的缺点：**电路交换效率低**，在静默期专用电路空闲，空闲的网络资源不能被其他进行中的连接使用；创建端到端电路和预留端到预留端的**宽带复杂**，需要信令软件来协调端到端路径的交换机的操作。

在**分组交换**中，各种应用程序在完成其任务时需要交换报文。报文可以执行一系列控制功能，或能够包含数据。主机将长报文划分为较小的数据块，并称之为分组packet。分组通过通信链路和分组交换机传送。

**存储转发传输**机制：在交换机能够开始向链路传输该分组的第一个比特之前，必须接受到整个分组。每个分组交换机有多条链路与之相连，对于每条相连的链路，分组交换机具有一个**输出队列**，用于储存准备发往那条链路的分组。因此分组需要承受排队的时延。由于储存空间有限，一个到达的分组可能发现该缓存被等待传输的分组充满了，就会出现**丢包Packet lost**。对比电路交换，我们可以得到分组交换使用按需分配链路资源，这种分配方式又称为**统计多路复用Statistical Multiplexing**。

### 1.3.2 分组是怎样通过分组交换网形成通路的

**路由器**使用分组的目的地址来索引**转发表**，向相邻的路由器转发该分组，一步一步找到合适的链路。因特网具有一些特殊的选路协议，它们用于自动地设置转发表。(不使用地图而喜欢问路)

### 1.3.3 ISP和因特网主干

在公共的因特网中，网络边缘接入网络通过**分层**的ISP层次结构。最顶层是数量相对少的第一层ISP（tier-1 ISP），这一层链路速率极高，第一层ISP（又称为因特网主干）直接与每一个第一层ISP连接，与大量第二层ISP和其他客户网络连接，覆盖国际区域。第二层ISP具有区域性或国家覆盖规模，需要引导流量通过它所连接的第一层ISP。

## 1.4 分组交换中的时延，丢包和吞吐量

### 1.4.1 时延

主要包括：节点处理时延，排队时延，传输时延和传播时延等，累加起来作为节点总时延。

* 处理时延：主要是检查分组首部和决定将该分组导向何处所需要的时间，还包括检查容错等消耗的时间。

* 排队时延： 排队时延取决于先到达的，正在排队等待向链路传输的分组的数量。

* 传输时延: **传输延时是路由器将分组推出所需要的时间**，等于**分组的长度**除以两路由器之间的**链路**传输速率。

* 传播时延：取决于链路的物理媒体，速率范围是2\*10^8~3\*10^8，等于**路由器距离除以传播速度**。

### 1.4.2 排队时延和丢包

**流量强度：分组平均比特数 * 分组到达队列的平均速率 / 比特从队列中推出的速率**，流量强度估计了排队时延的影响程度。 设计系统时流量强度不能大于1，否则会造成拥堵。（进入的/出去的，一直大于1会拥堵，丢包）

丢包：当没有地方储存新的分组，**路由器**将丢弃该分组，**丢包数量随流量强度的增大而增加**。丢失的分组可能要基于端到端的原则重传，以确保所有数据到达了目的地。

### 1.4.3 端到端时延

**我们上面的讨论都是单对节点之间的时延，端到端时延指从源到目的地的总时延，需考虑经过的路由器的个数**。

### 1.4.4 吞吐量

瞬时吞吐量：接收端主机接受到文件的速率；平均吞吐量：**传输文件大小/传输用时**。

在服务器与客户端有多条链路的网络中，服务器传输的吞吐量是所有链路传输速率的最小值，即瓶颈链路的速率。吞吐量还取决于干扰流量。

## 1.5 协议层次与它们的服务模型

### 1.5.1 分层的结构体系

分层提供了一种结构化的方式来讨论系统组件。

各层的所有协议被称为协议栈，因特网的协议栈由：**物理层、链路层、网络层、运输层和应用层**。

1. 应用层：网络应用程序及其应用协议存留的地方，常见协议有HTTP、SMTP、FTP。应用层协议分布在多个端系统上，一个端系统中的应用程序使用协议与另一个端系统中的应用程序交换分组信息。我们将这种位于应用层的信息分组称为报文。

2. 运输层：提供了在应用程序端点之间传送应用层报文的服务。两个运输层协议分别是TCP和UDP。TCP提供了**面向连接**的服务，并提供拥塞控制机制和流量控制；UDP提供**面向无连接**的服务，不提供可靠性保障。我们将运输层分组成为报文段。

3. 网络层：负责将数据报datagram的网络层分组从一台主机移动到另一台主机上。IP协议定义了数据报中的各个字段以及端系统和路由器如何做用于这些字段。因特网的网络层也包括决定路由的选路协议。

4. 链路层：在每一个节点，网络层将数据下传给链路层，链路层沿着路径将数据报传递给下一个节点，在下一个节点，链路层再将数据报上传给网络层。我们将链路层分组成为帧frame。

5. 物理层：物理层的任务是将帧的一个一个比特从一个节点移动到下一个节点。

6. ISO模型：国际标准化组织ISO在上个世纪七十年代提出了七层的开放系统互联模型OSI。OSI参考模型的七层是：**应用、表示、会话**、传输、网络、链路、物理。表示层的作用是使通信的应用程序能够解释交换数据的含义，提供数据压缩，数据加密，数据描述等功能；会话层提供了数据交换的定界和同步功能。

### 1.5.2 报文，报文段，数据报和帧

数据从发送端系统的协议栈向下，上下中间的链路层交换机和路由器协议栈，进而向上到达接收端系统的协议栈。链路层交换机实现了链路层和物理层，路由器实现了网络、链路、物理层。

这个向下的过程也是一层一层往下封装的过程。

## 1.6 攻击威胁下的网络

1. 经因特网将恶意软件放入你的计算机

2. 攻击服务器和网络基础设施

3. 嗅探分组

4. 伪装

5. 修改或删除报文

## 1.7 计算机网络和因特网的历史（阅读资料）

