# 第五次计算机网络作业

郑有为 19335286

**1 分片 ALOHA 的效率高于纯 ALOHA，解释原因。** 

首先，梳理二者的工作原理：

* 分片ALOHA有以下假设：所有帧由恰好L比特组成，时间被划分为长度为L/R s的时隙，节点只在时隙起点开始传输帧，节点是同步的，若一个时隙中有碰撞，在时隙结束前能检测到该碰撞事件。

* 分片ALOHA的工作原理是基于上述假设的：当节点有新帧要发送时，需要等待下一个时隙开始并在该时隙传输该帧。没有碰撞则成功传输，否则该节点以概率P在后续的每个时隙中重传它的帧，直到传输成功。

* 而对于纯ALOHA：没有分片ALOHA的诸多假设当一帧首次到达，节点立刻将该帧完整地传输进广播信道，若传输的一个帧与一个或多个传输经受了碰撞，这个节点立即以概率p重传，否则等待一个帧传输时间。

二者效率的比较需要通过计算平均一个节点成功传送的概率：

* 分片ALOHA：在计算前，我们假设每个节点试图在每个时隙以概率p传输一帧，假设有N个节点，则一个给定时隙是成功时隙的概率是一个节点传输而其他N-1个节点不传输的概率，它们相互独立，故传送成功的概率是$p(1-p)^{(n-1)}$，因为有N个节点，任意一个节点成功传送的概率是$Np(1-p)^{(N-1)}$，当p取$1/e$（约等于0.37）时，该协议有最大效率$1/e$。
* 纯ALOHA：在计算前，同样采用帧传输时间作为时间单元，在任何给定时间，某个节点传输一个帧的概率是p，假设在时刻$t_0$开始传输，该帧成功传输的前提是在$[t_0-1, t_0]$内没有节点开始传输，在$[t_0, t_0+1]$内也没有节点开始传输，否则会发生重叠，因此，给定一个节点传输成功一次的概率是$p(1-p)^{2(N-1)})$，因为有N个节点，任意一个节点成功传送的概率是$Np(1-p)^{2(N-1)}$，当p取$1/(2e)$，该协议有最大效率$1/(2e)$。
* 比较二者一个节点成功传送的概率，分片ALOHA是纯ALOHA的两倍，故效率更高。 

**2 简述 802.3 发生冲突后所用重发算法的工作原理。** 

* 802.3 发生冲突后所用重发算法为**指数后退算法**。
* 发生冲突后，适配器进入一个指数后退阶段，在该帧经受了一连串的第n次碰撞后，适配器随机地从$\{0, 1, 2, 3, ... ,2^m-1\}$中选一个值k，其中$m = min\{n, 10\}$，然后适配器等待$512k$比特时间再重新监听信道，若信道空闲则重发。

**3 在 802.3 中，CD（冲突检测）可提高 CSMA 协议的效率，解释在 802.11 中用 CA（冲突避免）而非 CD 的原因。** 

1. 检测碰撞CD的要求站点具有同时发送（发送站点自己的信号）和接收（其他站点是否在发送）的能力。而在802.11适配器上，接收信号的强度远远小于发送信号的强度，接收信号会被覆盖，构建具有检测碰撞能力的硬件难度较大。
2. 即使适配器能够同时发送和接收侦听信号，适配器也会因为隐藏终端和衰减问题而无法检测所有的碰撞。

**4 从协议层的角度，解释以下网络设备的用途：集线器，交换机，路由器。** 

* 集线器是物理层设备，交换机是链路层设备，路由器是网络层设备。

* 集线器：物理层设备，作用于各比特而不是帧，集线器负责重新生成到达的比特，放大其能量的强度，再传送出去。然而，若集线器同时从两个不同的接口接收到帧，出现一次碰撞，生成该帧的节点必须重新传输该帧。

* 交换机：链路层设备，接收入链路层帧并将它们转发到出链路，**转发依据链路层MAC地址**。两大用途是转发和过滤：

  * 过滤：交换机决定一个帧是应该转发到某个接口还是应当将其丢弃。
  * 转发：决定一个帧应该被导向哪个接口，并把该帧接口移动到这些接口的交换机功能。

  交换机的过滤和转发都需要依靠交换机表完成，**交换机是自学习的，能自动、动态地建立交换机表**。

* 路由器：网络层设备，从输入端口接收分组并将它们转发到指定的输出端口，**转发依据网络层IP地址**。两大用途为转发和选路：

  * 转发：当一个分组到达某路由器的一条输入链路时，该路由器必须将该分组移动到适当的输出链路。
  * 选路：当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径，计算这些路径的算法称为选路算法。

  一台路由器有一个转发表，路由器通过检查分组信息来作为转发表的索引查出报文对应的输出链路。

**5 假设一个以太网：两个节点间的最大距离为 2000m，数据发送速率为 10Mbps，信号在电缆中的传播速度为 200000km/s，计算最小的帧长度**。

* 最小帧长度的提出是为**保证网络正常进行冲突检测**：考虑如下的情况，主机发送的帧很小，而两台冲突主机相距很远，在主机A发送的帧传输到B的前一刻，B开始发送帧。这样，当A的帧到达B时，B检测到冲突，于是发送冲突信号。假如在B的冲突信号传输到A之前，A的帧已经发送完毕，那么A将检测不到冲突而误以为已发送成功。

* 信号在总线上最大往返传输时间 t 等于两倍的节点最大距离除以信号传播速度：
  $$
  t = 2\times10^3 / 2\times10^8 \times 2= 2\times10^{-5}\text{s}
  $$

* 最小的帧长度 l 等于数据发送数据乘以往返最大传输时间 t ：
  $$
  l = 1\times10^7 \times 2 \times 10^{-5} = 200 \text{bits}
  $$

**6 以课程所学协议为例，总结五层互联网模型的数据链路层、网络层和传输层的用途。** 

* 数据链路层：
  * 数据链路层位于网络层与物理层之间，用来在独立的链路上移动数据报。它定义了在**链路端点两端的节点**之间交互的分组格式，以及当发送和接受这些分组时这些节点所采用的动作。
  * 将上层数据包通过路径中的单端链路节点到节点地传送。在不同的路径上可由不同的链路层协议所承载，并且不同协议提供的服务可不同。
  * 链路层协议包括：**以太网、802.11无线LAN、令牌环和PPP**等等。
* 网络层：
  * 网络层位于传输层和数据链路层之间，为运输层提供实现**主机到主机的通信服务**，将分组从一台主机发送到另一台主机。
  * 网络层在数据链路层提供的两个相邻端点之间的数据帧的传送功能上，进一步管理网络中的数据通信，将数据设法从源端经过若干个中间节点传送到目的端，从而向运输层提供最基本的端到端的数据传送服务。
  * 网络层协议主要是IP协议。
* 传输层：
  * 传输层位于应用层和网络层之间，为不同主机上的应用进程提供直接的逻辑通信服务。应用进程使用运输层提供的逻辑通信功能彼此发送报文，而无需考虑承载这些报文的物理基础设施的细节。
  * 传输层协议主要是TCP协议和UDP协议，前者提供有连接的可靠服务，后者提供无连接的不可靠服务。

**7 以电邮加密和签名为例，解释对称和非对称加密算法的用法。** 

**电邮的加密**

* 在电邮的加解密过程中，综合考虑安全性和效率，对称加密和非对称加密算法都被使用到了。我们使用非对称加密算法加密会话密钥，再用会话密钥来加密报文，会话密钥对应的是对称加密算法。

* 大致用法如下（A发送报文给B的过程）：

  * 加密并发送过程：
    1. **A选择一个对称会话密钥 $K_s$**
    2. **然后使用 $K_s$ 加密它的报文**
    3. **用B的公钥 $K_b^+$ 来加密 $K_s$**
    4. **将加密后的报文和加密后的对称密钥级联成一个包**
    5. **将生成的包发送给B**
  * 接收并解密过程：
    1. **B用自己的私钥 $K_b^-$ 得到对称密钥 $K_s$**
    2. **使用对称密钥 $K_s$ 解密报文 $m$**

* 以下是加解密的示意图：

  ![image-20210627195123172](C:\Users\17727\AppData\Roaming\Typora\typora-user-images\image-20210627195123172.png)

**电邮的签名**

* 提供数字签名以实现邮件的鉴别和报文完整性检测，在这个过程对报文使用了散列函数，再用私钥对散列结果进行签名，利用了非对称加密算法。

* 大致用法如下（A发送报文给B的过程）：

  * A进行签名：
    1. **对报文$m$应用散列函数H得到报文摘要$H(m)$**
    2. **用私钥 $K_A^-$ 对报文摘要 $H(m)$ 进行数字签名得到 $K_A^-(H(m))$**
    3. **把报文和数字签名级联在一起形成一个包**
    4. 加密并发送报文（加密并发送过程）
  * B进行身份鉴定：
    1. 接收并解密报文（接收并解密过程）
    2. **将A的公钥 $K_A^+$ 应用到被签名的报文摘要 $K_A^-(H(m))$ 上，即计算 $K_A^+(K_A^-(H(m)))$**
    3. **将上一步结果与他自己对报文使用散列函数的得到的结果 $H(m)$ 相比较，若结果相同则说明报文确实来自A且未被篡改**。

* 以下是忽略了加解密的示意图：

  ![image-20210627201228103](C:\Users\17727\AppData\Roaming\Typora\typora-user-images\image-20210627201228103.png)

**8 SSL 和 IPsec 是常用的互联网通信加密协议，分别运作于协议栈的不同位置，从应用角度对两种协议的优缺点进行对比分析。**

* SSL（安全套接字层）运作于TCP之上，被应用于运行在TCP之上的所有应用程序，SSL提供了一个简单的具有套接字的API。
  * 优点：
    * **连接是私有的，可满足一些应用服务程序的客户鉴别要求**，适用于点对点之间的信息传输，常用Web Server方式。
    * **提供加密、数据完整性、鉴别**
    * SSL为带有安全功能的TCP/IP套接字应用程序接口提供了一个替代的方法，在SSL之上可以安全方式运行任何原有TCP/IP应用程序而不需修改。
  * 缺点：
    * **适用范围有限，不适用于基于UDP或者其他非TCP协议的应用。**
    * **SSL要求对每个数据进行加密和解密操作，因而在带来高性能的同时，对系统也要求高资源开销。**
* IPsec（IP安全）运作与网络层。
  * 优点：
    * **适用范围广**，灵活：在网络实体对之间具有机密性，发送实体加密它发送给接收实体的所有数据包的载荷，可以装载任何上层协议。
    * **对嗅探方隐形**：从一个实体向其他实体发送的所有数据报将隐形于任何可能嗅探该网络的第三方。
    * **潜在性地提供了其他安全性服务**，包括
      * **源鉴别**：使得实体能够核对在数据报的源
      * **数据完整性**：使得接收实体核能够核对对任何可能的篡改
      * **防止重放攻击**：检测任何攻击者插入的冗余数据报
  * 缺点：
    * 在某些情况下，不可以进行直接的端到端通信(即传输模式)。
    * IPsec过于复杂性，为满足满足标准化机构的各个派系，IPsec功能和选项繁多，在理解和实现上有难度。